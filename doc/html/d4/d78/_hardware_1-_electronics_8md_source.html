<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BeeSafe Project: doc/wiki/Hardware:-Electronics.md Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../beeSmall.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BeeSafe Project
   &#160;<span id="projectnumber">v1.0</span>
   </div>
   <div id="projectbrief">Low-cost tracking device.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d4/d78/_hardware_1-_electronics_8md.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">doc/wiki/Hardware:-Electronics.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d78/_hardware_1-_electronics_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;This page discusses the electronic components and considerations made for designing the schematic and layout.</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;* The newest schematic as a _.pdf_ can always be found in the root of the [`hardware`](https://github.com/itsBelinda/ENG5220-2020-Team13/tree/master/hardware) folder. </div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;* The needed Gerber files of the latest revision are in the [`PCBProduction`](https://github.com/itsBelinda/ENG5220-2020-Team13/tree/master/hardware/PCBProduction) folder, </div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;* together with the complete [`Bill of Material (BOM)`](https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/hardware/PCBProduction/BEESAFE.BOM).</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;&lt;p align=&quot;center&quot;&gt;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  &lt;img src=&quot;https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/doc/media/pcb_hat.jpeg&quot; alt=&quot;GSM/GPRS header for Raspberry PI using a SARA-G3 u-blox module&quot; width=&quot;80%&quot;&gt;     </div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Note: This picture is the untested hardware V1.1 and still has an error in the voltage translator configuration.</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;&lt;/p&gt;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;# Contents</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;* [`GSM/GPRS Module`](#gsmgprs-module-u-Blox-SARA-G350-02X-01)</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;* [`Power Supply`](#power-supply)</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;* [`Voltage Translator`](#voltage-translator)</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;* [`Antenna`](#antenna)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;* [`SIM Card`](#sim-card)</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;* [`Tall Header`](#tall-header)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;## GSM/GPRS Module u-Blox SARA-G350-02X-01</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;The mobile connectivity is provided by the SARA-G350-02X-01 module (hereafter: SARA module).  </div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;The original idea of the project was to have a GSM and a GPRS module. However, each of these costs about 20£ when bought in low quantities and 40£ is the budget for this project, there would be nothing left for the rest of the necessary components. A module that provides both functionalities in one is often more expensive than those 40£ because it is highly integrated and optimised for space. Additionally, these tiny modules would be impossible to solder without a solder stop mask.  </div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;This is where the SARA module comes into play. It provides the so-called &lt;a href=&quot;./uBlox-and-CellLocate&quot; target=&quot;_blank&quot;&gt;`CellLocate`&lt;/a&gt; feature. A way to determine the location of the module based on mobile network information. In certain cases, it can provide location information when there is no GPS signal available (for example indoors), or it can improve the estimated GPS location.   </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;When used on its own, CellLocate might not be as accurate as GPS.  </div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;The SARA module provides the possibility to connect a GPS module if this prototype proves to be not accurate enough. </div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;### Connection to the PI</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;The communication to the Raspberry PI is done through a UART interface. The SARA module provides two UART interfaces, one 9-pin providing full hardware flow control and one auxiliary UART interface using only RX and TX signals. Additionally, two GPIOs are connected to the PI that alow the SARA module to send interrupts to the PI (can be configured in software). </div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;The signal names of the SARA modules’ UART  interface conform to the ITU-T V.24 Recommendation: e.g. the TXD line represents the data transmitted by the DTE (Raspberry PI) and received by the DCE (SARA module). Therefore, the RX/TX line from the PI and the SARA module can be connected TX-TX and RX-RX. However, the two devices operate on different voltage levels, so a [voltage translator](#voltage-translator) is needed.</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;### SIM Card Connection</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;The [SIM Card](#sim-card) is directly connected to the SARA module, the SARA module provides the power supply for the SIM card.</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;### Power On and Reset</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;The SARA module has both a PWR_ON and a RESET_N pin. For normal operation, they both have to be at a high level. The PWR_ON pin must be connected to 3V8 with a 100 kΩ resistor. The RESET_N pin has an internal pull-up, it is not connected. A reset can also be forced through an AT command, the RESET_N pin is only needed if this fails. </div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;The PWR_ON pin is connected to GND by a resistor that is not connected (NC). This was done to have the possibility to implement this function during development. Similarly, the RESET_N pin connects to a 0 Ω resistor, to give access to the pad during development, should it be needed.</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;### 0 Ω Resistors </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;Most pins connected to the SARA module and some additional ones are separated from the rest of the circuit through 0 Ω resistors. This was done to be flexible during development. The main UART could be swapped with the auxiliary one, RX/TX could be changed if necessary, or additional features (GPIO or reset) could be connected to the PI.</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;During development, we were able to change the direction of the voltage translator, because that was configured incorrectly. The result does not look very pretty, but it works. No new PCB had to be manufactured.</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;&lt;p align=&quot;center&quot;&gt;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  &lt;img src=&quot;https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/doc/media/hw_fix.jpg&quot; alt=&quot;Hardware fix: Changing the direction of the voltage translator.&quot; width=&quot;30%&quot;&gt;     </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;&lt;/p&gt;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;### Important Links</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;#### General Information about the Module:</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;* [u-Blox SARA-G3 website](https://www.u-blox.com/en/product/sara-g3-series)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;* [Datasheet](https://www.u-blox.com/en/docs/UBX-13000993)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;* [Position Implementation Application Note](https://www.u-blox.com/sites/default/files/GNSS-Implementation_AppNote_%28UBX-13001849%29.pdf)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;#### Information about Hardware Development:</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;* [System Integration Manual](https://www.u-blox.com/en/docs/UBX-13000995)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;#### Software Integration</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;* [Command Examples](https://www.u-blox.com/sites/default/files/AT-CommandsExamples_AppNote_%28UBX-13001820%29.pdf)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;* [Complete Command Guide](https://www.u-blox.com/en/docs/UBX-13002752)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;* [Example C-library](https://github.com/u-blox/cellular) (under development at time of writing)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;## Power Supply</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;The PI supplies 5 V directly from the USB connection and 3.3V for its digital in- and outputs. </div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;The SARA module, however, needs a supply voltage of 3.8 V typically (3.35 - 4.5 V max). The module peak of current consumption through all the VCC pins, during data transmission, burst at maximum power level, with a mismatched antenna is 1.9 A (1.5 A with a matched antenna). </div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;The SIM Card runs on 1.8 V. Because the SARA module communicates directly with the SIM card, its digital interfaces also run on 1.8 V and the SIM can be supplied by the SARA module directly. </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;### Generating 3.8 V</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;The 3.8 V is generated from the 5 V supply using a Low Dropout Regulator (LDO) from Linear Technology (LT1764 series, adjustable device, see [`BOM`](https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/hardware/PCBProduction/BEESAFE.BOM)) with the recommended schematic design (find full schematic in [`hardware`](https://github.com/itsBelinda/ENG5220-2020-Team13/tree/master/hardware)). It can provide a current of up to 3 A. </div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;## Voltage Translator</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;For the communication between the PI (3.3 V) and the SARA module (1.8 V) to work, a 4-bit noninverting bus transceiver with two separate configurable power-supply rails from Texas Instruments was used (see [`BOM`](https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/hardware/PCBProduction/BEESAFE.BOM)). It translates UART TX from the PI to the module and UART RX and two GPIOs from the module to the PI.</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;It is permanently activated by pulling the ~OE pin to GND (pulling it to supply voltage would put all ports into high impedance state). The direction is set by pulling the direction pin to GND for transmission from port A (Raspberry PI) to port B (SARA module) or to supply voltage for transmission from port B (SARA module) to port A (Raspberry PI).</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;## Antenna</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;To be on the save side, an external antenna connected to the standard SMA connector is used.</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;The used antenna is the **W3404SMA** from Pulse Larsen Antennas and has a frequency range of **698MHz ~ 960MHz** and **1.71GHz ~ 2.69GHz**. </div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;The most important requirements are:</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;* 50 Ω nominal characteristic impedance</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;* Frequencies include 900 MHz and 1.8 GHz</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;* Return Loss S&lt;sub&gt;11&lt;/sub&gt; &lt; -10 dB (&lt; 6 dB acceptable)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;* Input Power &gt; 2W</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;### Layout considerations</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;Using an external antenna gets rid of most layout problems that would be caused by an onboard antenna. The connection from the antenna pin of the SARA module to the SMA connector is kept as short as possible. This should not cause any problems as long as the connection is shorter than 1/4 of the wavelength (418 mm for 1.8 GHz).</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;## SIM Card</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;The SIM card adapter accepts micro-SIM cards with a push-pull mechanic. The footprint seems to be very similar/the same to many micro-SIM adapters. The exact component can be found in the [`BOM`](https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/hardware/PCBProduction/BEESAFE.BOM).</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;To protect the circuit from RF coupling (especially from the antenna), several bypass capacitors were placed close to the pads of the SIM connector as well as ESD protection diodes as recommended by the hardware integration manual of the SARA module. The newest version of the schematic can be found in the root of the [`hardware`](https://github.com/itsBelinda/ENG5220-2020-Team13/tree/master/hardware) folder.</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;Optional SIM detection from the SARA module is not supported by this hardware version.</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;## Tall Header</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;The expansion board has the same size as the Raspberry PI. Because the USB ports on the PI are too high for a standard header, an extra tall one is needed. [`This is one example, specifically made for this purpose by Adafruit`](https://www.adafruit.com/product/1992).</div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d4/d78/_hardware_1-_electronics_8md.html">Hardware:-Electronics.md</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
