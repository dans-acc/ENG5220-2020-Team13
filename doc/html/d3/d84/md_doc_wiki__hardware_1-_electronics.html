<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BeeSafe Project: Hardware:-Electronics</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../beeSmall.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BeeSafe Project
   &#160;<span id="projectnumber">v1.0</span>
   </div>
   <div id="projectbrief">Low-cost tracking device.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d3/d84/md_doc_wiki__hardware_1-_electronics.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Hardware:-Electronics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page discusses the electronic components and considerations made for designing the schematic and layout.</p><ul>
<li>The newest schematic as a _.pdf_ can always be found in the root of the <a href="https://github.com/itsBelinda/ENG5220-2020-Team13/tree/master/hardware"><code>hardware</code></a> folder.</li>
<li>The needed Gerber files of the latest revision are in the <a href="https://github.com/itsBelinda/ENG5220-2020-Team13/tree/master/hardware/PCBProduction"><code>PCBProduction</code></a> folder,</li>
<li>together with the complete <a href="https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/hardware/PCBProduction/BEESAFE.BOM"><code>Bill of Material (BOM)</code></a>.</li>
</ul>
<div class="image">
<img src="https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/doc/media/pcb_hat.jpeg" alt="GSM/GPRS header for Raspberry PI using a SARA-G3 u-blox module" width="80%"/>
</div>
<p>Note: This picture is the untested hardware V1.1 and still has an error in the voltage translator configuration. </p>
<h1>Contents</h1>
<ul>
<li><a href="../../#gsmgprs-module-u-Blox-SARA-G350-02X-01"><code>GSM/GPRS Module</code></a></li>
<li><a href="../../#power-supply"><code>Power Supply</code></a></li>
<li><a href="../../#voltage-translator"><code>Voltage Translator</code></a></li>
<li><a href="../../#antenna"><code>Antenna</code></a></li>
<li><a href="../../#sim-card"><code>SIM Card</code></a></li>
<li><a href="../../#tall-header"><code>Tall Header</code></a></li>
</ul>
<h2>GSM/GPRS Module u-Blox SARA-G350-02X-01</h2>
<p>The mobile connectivity is provided by the SARA-G350-02X-01 module (hereafter: SARA module).</p>
<p>The original idea of the project was to have a GSM and a GPRS module. However, each of these costs about 20£ when bought in low quantities and 40£ is the budget for this project, there would be nothing left for the rest of the necessary components. A module that provides both functionalities in one is often more expensive than those 40£ because it is highly integrated and optimised for space. Additionally, these tiny modules would be impossible to solder without a solder stop mask.</p>
<p>This is where the SARA module comes into play. It provides the so-called <a href="../.././uBlox-and-CellLocate" target="_blank"><code>CellLocate</code></a> feature. A way to determine the location of the module based on mobile network information. In certain cases, it can provide location information when there is no GPS signal available (for example indoors), or it can improve the estimated GPS location. When used on its own, CellLocate might not be as accurate as GPS. The SARA module provides the possibility to connect a GPS module if this prototype proves to be not accurate enough.</p>
<h3>Connection to the PI</h3>
<p>The communication to the Raspberry PI is done through a UART interface. The SARA module provides two UART interfaces, one 9-pin providing full hardware flow control and one auxiliary UART interface using only RX and TX signals. Additionally, two GPIOs are connected to the PI that alow the SARA module to send interrupts to the PI (can be configured in software).</p>
<p>The signal names of the SARA modules’ UART interface conform to the ITU-T V.24 Recommendation: e.g. the TXD line represents the data transmitted by the DTE (Raspberry PI) and received by the DCE (SARA module). Therefore, the RX/TX line from the PI and the SARA module can be connected TX-TX and RX-RX. However, the two devices operate on different voltage levels, so a <a href="../../#voltage-translator">voltage translator</a> is needed.</p>
<h3>SIM Card Connection</h3>
<p>The <a href="../../#sim-card">SIM Card</a> is directly connected to the SARA module, the SARA module provides the power supply for the SIM card.</p>
<h3>Power On and Reset</h3>
<p>The SARA module has both a PWR_ON and a RESET_N pin. For normal operation, they both have to be at a high level. The PWR_ON pin must be connected to 3V8 with a 100 kΩ resistor. The RESET_N pin has an internal pull-up, it is not connected. A reset can also be forced through an AT command, the RESET_N pin is only needed if this fails.</p>
<p>The PWR_ON pin is connected to GND by a resistor that is not connected (NC). This was done to have the possibility to implement this function during development. Similarly, the RESET_N pin connects to a 0 Ω resistor, to give access to the pad during development, should it be needed.</p>
<h3>0 Ω Resistors</h3>
<p>Most pins connected to the SARA module and some additional ones are separated from the rest of the circuit through 0 Ω resistors. This was done to be flexible during development. The main UART could be swapped with the auxiliary one, RX/TX could be changed if necessary, or additional features (GPIO or reset) could be connected to the PI.</p>
<p>During development, we were able to change the direction of the voltage translator, because that was configured incorrectly. The result does not look very pretty, but it works. No new PCB had to be manufactured.</p>
<div class="image">
<img src="https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/doc/media/hw_fix.jpg" alt="Hardware fix: Changing the direction of the voltage translator." width="30%"/>
</div>
 <h3>Important Links</h3>
<h4>General Information about the Module:</h4>
<ul>
<li><a href="https://www.u-blox.com/en/product/sara-g3-series">u-Blox SARA-G3 website</a></li>
<li><a href="https://www.u-blox.com/en/docs/UBX-13000993">Datasheet</a></li>
<li><a href="https://www.u-blox.com/sites/default/files/GNSS-Implementation_AppNote_%28UBX-13001849%29.pdf">Position Implementation Application Note</a> <h4>Information about Hardware Development:</h4>
</li>
</ul>
<ul>
<li><a href="https://www.u-blox.com/en/docs/UBX-13000995">System Integration Manual</a> <h4>Software Integration</h4>
</li>
</ul>
<ul>
<li><a href="https://www.u-blox.com/sites/default/files/AT-CommandsExamples_AppNote_%28UBX-13001820%29.pdf">Command Examples</a></li>
<li><a href="https://www.u-blox.com/en/docs/UBX-13002752">Complete Command Guide</a></li>
<li><a href="https://github.com/u-blox/cellular">Example C-library</a> (under development at time of writing)</li>
</ul>
<h2>Power Supply</h2>
<p>The PI supplies 5 V directly from the USB connection and 3.3V for its digital in- and outputs. The SARA module, however, needs a supply voltage of 3.8 V typically (3.35 - 4.5 V max). The module peak of current consumption through all the VCC pins, during data transmission, burst at maximum power level, with a mismatched antenna is 1.9 A (1.5 A with a matched antenna).</p>
<p>The SIM Card runs on 1.8 V. Because the SARA module communicates directly with the SIM card, its digital interfaces also run on 1.8 V and the SIM can be supplied by the SARA module directly.</p>
<h3>Generating 3.8 V</h3>
<p>The 3.8 V is generated from the 5 V supply using a Low Dropout Regulator (LDO) from Linear Technology (LT1764 series, adjustable device, see <a href="https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/hardware/PCBProduction/BEESAFE.BOM"><code>BOM</code></a>) with the recommended schematic design (find full schematic in <a href="https://github.com/itsBelinda/ENG5220-2020-Team13/tree/master/hardware"><code>hardware</code></a>). It can provide a current of up to 3 A.</p>
<h2>Voltage Translator</h2>
<p>For the communication between the PI (3.3 V) and the SARA module (1.8 V) to work, a 4-bit noninverting bus transceiver with two separate configurable power-supply rails from Texas Instruments was used (see <a href="https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/hardware/PCBProduction/BEESAFE.BOM"><code>BOM</code></a>). It translates UART TX from the PI to the module and UART RX and two GPIOs from the module to the PI.</p>
<p>It is permanently activated by pulling the ~OE pin to GND (pulling it to supply voltage would put all ports into high impedance state). The direction is set by pulling the direction pin to GND for transmission from port A (Raspberry PI) to port B (SARA module) or to supply voltage for transmission from port B (SARA module) to port A (Raspberry PI).</p>
<h2>Antenna</h2>
<p>To be on the save side, an external antenna connected to the standard SMA connector is used. The used antenna is the <b>W3404SMA</b> from Pulse Larsen Antennas and has a frequency range of <b>698MHz ~ 960MHz</b> and <b>1.71GHz ~ 2.69GHz</b>.</p>
<p>The most important requirements are:</p><ul>
<li>50 Ω nominal characteristic impedance</li>
<li>Frequencies include 900 MHz and 1.8 GHz</li>
<li>Return Loss S<sub>11</sub> &lt; -10 dB (&lt; 6 dB acceptable)</li>
<li>Input Power &gt; 2W</li>
</ul>
<h3>Layout considerations</h3>
<p>Using an external antenna gets rid of most layout problems that would be caused by an onboard antenna. The connection from the antenna pin of the SARA module to the SMA connector is kept as short as possible. This should not cause any problems as long as the connection is shorter than 1/4 of the wavelength (418 mm for 1.8 GHz).</p>
<h2>SIM Card</h2>
<p>The SIM card adapter accepts micro-SIM cards with a push-pull mechanic. The footprint seems to be very similar/the same to many micro-SIM adapters. The exact component can be found in the <a href="https://github.com/itsBelinda/ENG5220-2020-Team13/blob/master/hardware/PCBProduction/BEESAFE.BOM"><code>BOM</code></a>.</p>
<p>To protect the circuit from RF coupling (especially from the antenna), several bypass capacitors were placed close to the pads of the SIM connector as well as ESD protection diodes as recommended by the hardware integration manual of the SARA module. The newest version of the schematic can be found in the root of the <a href="https://github.com/itsBelinda/ENG5220-2020-Team13/tree/master/hardware"><code>hardware</code></a> folder.</p>
<p>Optional SIM detection from the SARA module is not supported by this hardware version.</p>
<h2>Tall Header</h2>
<p>The expansion board has the same size as the Raspberry PI. Because the USB ports on the PI are too high for a standard header, an extra tall one is needed. <a href="https://www.adafruit.com/product/1992"><code>This is one example, specifically made for this purpose by Adafruit</code></a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
